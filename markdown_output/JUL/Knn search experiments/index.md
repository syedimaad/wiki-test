Hardware: AWS c6i.metal, vCPU 128, RAM 256 GiB\
Software: Simple-Web-Server based, 128 web server threads\
HNSW construction params: M 16, ef_construction 500\
Construction time is less than 2 hours for 768 and 128 embeddings

For k=20 ef 100, for other values of k ef is equal to k\

**Note**: after adding string item ids performance decreased by 10-20%
(queries per second). Also memory consumption is increased by 10 GB.\
Below results for integer item ids.

### AWS c6i.metal vCPU 128, RAM 256 GiB

Data: PCA BLIP embeddings 128 dim, 35M vectors

+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| **Requests | **Request latency, ms**\                                  | **Recall** | **Query    | **K nearest  | **CPU  | **RAM, GB** | **Number  |
| Per        | **(send request + receive response)**                     |            | size       | neighbours** | usage, |             | of load   |
| Second**   |                                                           |            | (number of |              | %**    |             | testers** |
|            |                                                           |            | vectors in |              |        |             |           |
|            |                                                           |            | a          |              |        |             |           |
|            |                                                           |            | request)** |              |        |             |           |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| p_50       | p_90      | p_99      | p_99_9    | max       |           |            |            |              |        |             |           |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 270        | 3.7       | 4.7       | 5.6       | 6.4       | 7.6       | 0.96       | 1          | 20           | 1%     | 35          | 1         |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 35000      | 3.4       | 4.4       | 6.2       | 8         | 16.2      | 0.96       | 1          | 20           | 60%    | 35          | 120       |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 12300      | 4.9       | 5.9       | 7.3       | 9.8       | 17.9      | 0.9        | 3          | 100          | 70%    | 35          | 60        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 7500       | 6.7       | 8.5       | 11.3      | 14.3      | 24        | 0.9        | 5          | 100          | 75%    | 35          | 50        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 3800       | 10.5      | 13.2      | 16.7      | 20.1      | 28.7      | 0.9        | 10         | 100          | 80%    | 35          | 40        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 8000       | 6.3       | 7.5       | 8.8       | 10.3      | 18.8      | 0.96       | 3          | 200          | 65%    | 35          | 50        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 4800       | 8.3       | 9.6       | 11.1      | 12.5      | 21.5      | 0.96       | 5          | 200          | 80%    | 35          | 40        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 2500       | 12        | 13.8      | 16        | 18.4      | 27.6      | 0.96       | 10         | 200          | 85%    | 35          | 30        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 4300       | 14        | 17.4      | 20.9      | 24        | 32.8      | 0.96       | 3          | 500          | 90%    | 35          | 60        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 2600       | 15.5      | 18.5      | 21.7      | 24.2      | 33.8      | 0.96       | 5          | 500          | 90%    | 35          | 40        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 1300       | 20.3      | 23.9      | 27.7      | 31.4      | 41.9      | 0.96       | 10         | 500          | 95%    | 35          | 27        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+

Reference qps from python code (only search, no server, no load testers,
CPU usage 100%):\
106 000 k=100 ef=100\
27 000 k=500 ef=500

### AWS c6i.8xlarge vCPU 32, RAM 64 GiB

Data: PCA BLIP embeddings 128 dim, 35M vectors,

+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| **Requests | **Request latency, ms**\                                  | **Recall** | **Query    | **K nearest  | **CPU  | **RAM, GB** | **Number  |
| Per        | **(send request + receive response)**                     |            | size       | neighbours** | usage, |             | of load   |
| Second**   |                                                           |            | (number of |              | %**    |             | testers** |
|            |                                                           |            | vectors in |              |        |             |           |
|            |                                                           |            | a          |              |        |             |           |
|            |                                                           |            | request)** |              |        |             |           |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| p_50       | p_90      | p_99      | p_99_9    | max       |           |            |            |              |        |             |           |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 350        | 2.8       | 3.3       | 3.9       | 4.3       | 5.1       | 0.96       | 1          | 20           | 1%     | 30          | 1         |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 10400      | 5.7       | 7.4       | 9.4       | 12        | 22.4      | 0.96       | 1          | 20           | 80%    | 30          | 60        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 4200       | 9.4       | 10.9      | 17.9      | 25.9      | 50.6      | 0.9        | 3          | 100          | 100%   | 30          | 40        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 2600       | 11.4      | 16        | 26.2      | 33.7      | 57.2      | 0.9        | 5          | 100          | 100%   | 30          | 30        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 1300       | 17.1      | 25.8      | 36        | 44.7      | 66.8      | 0.9        | 10         | 100          | 100%   | 30          | 23        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 2700       | 9.7       | 12        | 19.3      | 26.9      | 42.1      | 0.96       | 3          | 200          | 100%   | 30          | 26        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 1600       | 11.6      | 15.7      | 25.4      | 30.9      | 43.4      | 0.96       | 5          | 200          | 100%   | 30          | 19        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 800        | 15.7      | 22.4      | 30.6      | 36.5      | 52.2      | 0.96       | 10         | 200          | 100%   | 30          | 13        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 1300       | 13.7      | 16.9      | 21.3      | 27.8      | 42.3      | 0.96       | 3          | 500          | 100%   | 30          | 18        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 800        | 15.3      | 18.5      | 22.4      | 27        | 36.2      | 0.96       | 5          | 500          | 100%   | 30          | 12        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 400        | 20        | 23.9      | 29        | 34        | 44.1      | 0.96       | 10         | 500          | 100%   | 30          | 8         |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+

\

### AWS c6a.8xlarge vCPU 32, RAM 64 GiB

Data: PCA BLIP embeddings 128 dim, 35M vectors

+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| **Requests | **Request latency, ms**\                                  | **Recall** | **Query    | **K nearest  | **CPU  | **RAM, GB** | **Number  |
| Per        | **(send request + receive response)**                     |            | size       | neighbours** | usage, |             | of load   |
| Second**   |                                                           |            | (number of |              | %**    |             | testers** |
|            |                                                           |            | vectors in |              |        |             |           |
|            |                                                           |            | a          |              |        |             |           |
|            |                                                           |            | request)** |              |        |             |           |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| p_50       | p_90      | p_99      | p_99_9    | max       |           |            |            |              |        |             |           |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 300        | 3.3       | 4         | 4.6       | 5.1       | 5.7       | 0.96       | 1          | 20           | 1%     | 30          | 1         |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 10000      | 6         | 7.5       | 9.7       | 12.4      | 21.5      | 0.96       | 1          | 20           | 80%    | 30          | 60        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 4100       | 7.9       | 10.1      | 20.4      | 26.5      | 46.1      | 0.9        | 3          | 100          | 100%   | 30          | 32        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 2500       | 9.6       | 13.7      | 24.1      | 32.9      | 56.6      | 0.9        | 5          | 100          | 100%   | 30          | 24        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 1300       | 13.3      | 20.2      | 31.2      | 44.6      | 78.2      | 0.9        | 10         | 100          | 100%   | 30          | 17        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 2500       | 9.2       | 12.1      | 21.3      | 28.5      | 51.7      | 0.96       | 3          | 200          | 100%   | 30          | 23        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 1500       | 10.6      | 14        | 23.1      | 32.3      | 54.2      | 0.96       | 5          | 200          | 100%   | 30          | 16        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 800        | 14.3      | 18.9      | 30.4      | 43.9      | 68.6      | 0.96       | 10         | 200          | 100%   | 30          | 11        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 1200       | 13.8      | 17.3      | 28.9      | 39.6      | 55.8      | 0.96       | 3          | 500          | 100%   | 30          | 17        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 700        | 15        | 18.3      | 32.6      | 43.5      | 59.1      | 0.96       | 5          | 500          | 100%   | 30          | 11        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+
| 400        | 18.9      | 22.4      | 40.8      | 54.8      | 80        | 0.96       | 10         | 500          | 100%   | 30          | 10        |
+------------+-----------+-----------+-----------+-----------+-----------+------------+------------+--------------+--------+-------------+-----------+

Data: BLIP embeddings 768 dim, 35M vectors, c6i.metal\
**Results are outdated**: no thread pool, load tester are on the same
server

+------------+-------------+------------+------------+--------------+--------+-------------+-----------+
| **Requests | **Request   | **Recall** | **Query    | **K nearest  | **CPU  | **RAM, GB** | **Number  |
| Per        | latency,    |            | size       | neighbours** | usage, |             | of load   |
| Second**   | ms**\       |            | (number of |              | %**    |             | testers** |
|            | **(send     |            | vectors in |              |        |             |           |
|            | request +   |            | a          |              |        |             |           |
|            | receive     |            | request)** |              |        |             |           |
|            | response)** |            |            |              |        |             |           |
+------------+-------------+------------+------------+--------------+--------+-------------+-----------+
| 120        | 8.4         | 0.95       | 1          | 20           | 1%     | 110         | 1         |
+------------+-------------+------------+------------+--------------+--------+-------------+-----------+
| 9200       | 13          | 0.95       | 1          | 20           | 95%    | 110         | 120       |
+------------+-------------+------------+------------+--------------+--------+-------------+-----------+
| 3200       | 19          | 0.9        | 3          | 100          | 80%    | 140         | 60        |
+------------+-------------+------------+------------+--------------+--------+-------------+-----------+
| 2000       | 25          | 0.9        | 5          | 100          | 75%    | 140         | 50        |
+------------+-------------+------------+------------+--------------+--------+-------------+-----------+
| 1000       | 40          | 0.9        | 10         | 100          | 80%    | 140         | 40        |
+------------+-------------+------------+------------+--------------+--------+-------------+-----------+
| 2300       | 26          | 0.92       | 3          | 200          | 90%    | 140         | 60        |
+------------+-------------+------------+------------+--------------+--------+-------------+-----------+
| 1400       | 37          | 0.92       | 5          | 200          | 90%    | 140         | 50        |
+------------+-------------+------------+------------+--------------+--------+-------------+-----------+
| 700        | 50          | 0.92       | 10         | 200          | 90%    | 140         | 35        |
+------------+-------------+------------+------------+--------------+--------+-------------+-----------+
| 1200       | 44          | 0.95       | 3          | 500          | 95%    | 140         | 54        |
+------------+-------------+------------+------------+--------------+--------+-------------+-----------+
| 700        | 54          | 0.95       | 5          | 500          | 92%    | 140         | 38        |
+------------+-------------+------------+------------+--------------+--------+-------------+-----------+
| 350        | 105         | 0.95       | 10         | 500          | 94%    | 140         | 32        |
+------------+-------------+------------+------------+--------------+--------+-------------+-----------+
